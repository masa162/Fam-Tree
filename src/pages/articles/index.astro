---
import BaseLayout from "../../layouts/BaseLayout.astro";
import HorizontalCard from "../../components/HorizontalCard.astro";
import { getCollection } from "astro:content";

/* æ–°ã—ã„é †ã«è¨˜äº‹ã‚’ä¸¦ã¹æ›¿ãˆ */
const articles = (await getCollection("articles")).sort(
  (a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()
);
---

<script is:inline>
  /* â”€â”€ æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  const input = document.getElementById("search");
  input?.addEventListener("input", () => {
    const kw = input.value.toLowerCase();
    document.querySelectorAll(".article-card").forEach((c) => {
      c.style.display = c.innerText.toLowerCase().includes(kw) ? "block" : "none";
    });
  });
</script>

<BaseLayout
  title="ã†ã¡ã®ãã‚ã"
  description="ã†ã¡ã®ãã‚ãã®è¨˜äº‹ä¸€è¦§ãƒšãƒ¼ã‚¸"
  image="/ogp.png"
  url="https://fam-tree.netlify.app/"
  sideBarActiveItemID="articles"
>
  <section class="max-w-4xl mx-auto px-6 py-12">
    <h1 class="text-4xl font-bold mb-6">ğŸŒ¿ è¨˜äº‹ä¸€è¦§</h1>

    <!-- æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ -->
    <div class="mb-8">
      <input
        id="search"
        type="text"
        placeholder="ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ï¼ˆä¾‹ï¼šæ¤ç‰©ã€ã”ã¯ã‚“ã€å¸°çœï¼‰"
        class="input input-bordered w-full"
      />
    </div>

    {articles.length === 0 ? (
      <p class="text-gray-500">è¨˜äº‹ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    ) : (
      <div class="space-y-6">
        {articles.map(({ slug, data }) => (
          <div class="article-card" ={slug}>
            <HorizontalCard
                  title={data.title}
                  desc={data.description}
                  img={data.heroImage ?? data.image ?? "/ogp.png"} 
                  url={`/articles/${slug}/`}
                  badge={data.badge ?? "uchinokiroku"}
                  tags={data.tags}
                  pubDate={data.pubDate}
                />
          </div>
        ))}
      </div>
    )}
  </section>
</BaseLayout>
